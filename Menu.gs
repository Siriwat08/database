/**
 * üñ•Ô∏è ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô: Menu UI
 * 
 * 
 */

function onOpen() {
  var ui = SpreadsheetApp.getUi();
  
  // =================================================================
  // üöõ ‡πÄ‡∏°‡∏ô‡∏π‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 1: ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Master Data Management)
  //
  // =================================================================
  ui.createMenu('üöõ 1. ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Master Data')
      .addItem('1Ô∏è‚É£ ‡∏î‡∏∂‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà (Sync New Data)', 'syncNewDataToMaster')
      .addItem('2Ô∏è‚É£ ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏¥‡∏Å‡∏±‡∏î/‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà (‡∏ó‡∏µ‡∏•‡∏∞ 50)', 'updateGeoData_SmartCache')
      .addItem('3Ô∏è‚É£ ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏ã‡πâ‡∏≥ (Clustering)', 'autoGenerateMasterList_Smart')
      .addSeparator()
      .addItem('üöÄ 5Ô∏è‚É£ Deep Clean (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå)', 'runDeepCleanBatch_100')
      .addItem('üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡∏õ‡∏∏‡πà‡∏° 5 (‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏ñ‡∏ß 2 ‡πÉ‡∏´‡∏°‡πà)', 'resetDeepCleanMemory')
      .addSeparator()
      .addItem('‚úÖ 6Ô∏è‚É£ ‡∏à‡∏ö‡∏á‡∏≤‡∏ô (Finalize & Move to Mapping)', 'finalizeAndClean_MoveToMapping')
      .addSeparator()
      .addSubMenu(ui.createMenu('üõ†Ô∏è Admin Tools (‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô)')
          .addItem('üîë ‡∏™‡∏£‡πâ‡∏≤‡∏á UUID ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡πÅ‡∏ñ‡∏ß (Database)', 'assignMissingUUIDs')
          .addItem('üöë ‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏° NameMapping (‡πÄ‡∏ï‡∏¥‡∏° ID + ‡∏•‡∏ö‡∏ã‡πâ‡∏≥)', 'repairNameMapping_Full')
      )
      .addToUi();

  // =================================================================
  // üì¶ ‡πÄ‡∏°‡∏ô‡∏π‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© SCG (Daily Operation)
  // 
  // =================================================================
  ui.createMenu('üì¶ 2. ‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© SCG') 
    .addItem('üì• 1. ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Shipment (+E-POD Calculation)', 'fetchDataFromSCGJWD')
    .addItem('üü¢ 2. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏û‡∏¥‡∏Å‡∏±‡∏î + ‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô', 'applyMasterCoordinatesToDailyJob')
    .addSeparator()
    .addSubMenu(ui.createMenu('üßπ ‡πÄ‡∏°‡∏ô‡∏π‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Clear Data)')
        .addItem('‡∏•‡πâ‡∏≤‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ä‡∏µ‡∏ï Data', 'clearDataSheet')
        .addItem('‡∏•‡πâ‡∏≤‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ä‡∏µ‡∏ï Input', 'clearInputSheet')
        .addItem('üí• ‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Input + Data)', 'clearAllSCGSheets')
    )
    .addToUi();

  // =================================================================
  // ü§ñ ‡πÄ‡∏°‡∏ô‡∏π‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 3: ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (Automation)
  // 
  // =================================================================
  ui.createMenu('ü§ñ 3. ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (Auto-Pilot)')
    .addItem('‚ñ∂Ô∏è ‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏≤‡∏ô (‡∏£‡∏±‡∏ô‡∏ó‡∏∏‡∏Å 10 ‡∏ô‡∏≤‡∏ó‡∏µ)', 'START_AUTO_PILOT')
    .addItem('‚èπÔ∏è ‡∏õ‡∏¥‡∏î‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠', 'STOP_AUTO_PILOT')
    .addToUi();
}

